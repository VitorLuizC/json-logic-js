!function(r,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((r=r||self).jsonLogic={})}(this,(function(r){"use strict";Array.isArray||(Array.isArray=function(r){return"[object Array]"===Object.prototype.toString.call(r)});var n={"==":function(r,n){return r==n},"===":function(r,n){return r===n},"!=":function(r,n){return r!=n},"!==":function(r,n){return r!==n},">":function(r,n){return r>n},">=":function(r,n){return r>=n},"<":function(r,n,t){return void 0===t?r<n:r<n&&n<t},"<=":function(r,n,t){return void 0===t?r<=n:r<=n&&n<=t},"!!":function(r){return e(r)},"!":function(r){return!e(r)},"%":function(r,n){return r%n},log:function(r){return console.log(r),r},in:function(r,n){return!(!n||void 0===n.indexOf)&&-1!==n.indexOf(r)},cat:function(){return Array.prototype.join.call(arguments,"")},substr:function(r,n,t){if(t<0){var e=String(r).substr(n);return e.substr(0,e.length+t)}return String(r).substr(n,t)},"+":function(){return Array.prototype.reduce.call(arguments,(function(r,n){return parseFloat(r,10)+parseFloat(n,10)}),0)},"*":function(){return Array.prototype.reduce.call(arguments,(function(r,n){return parseFloat(r,10)*parseFloat(n,10)}))},"-":function(r,n){return void 0===n?-r:r-n},"/":function(r,n){return r/n},min:function(){return Math.min.apply(this,arguments)},max:function(){return Math.max.apply(this,arguments)},merge:function(){return Array.prototype.reduce.call(arguments,(function(r,n){return r.concat(n)}),[])},var:function(r,n){var t=void 0===n?null:n,e=this;if(void 0===r||""===r||null===r)return e;for(var i=String(r).split("."),u=0;u<i.length;u++){if(null===e)return t;if(void 0===(e=e[i[u]]))return t}return e},missing:function(){for(var r=[],n=Array.isArray(arguments[0])?arguments[0]:arguments,t=0;t<n.length;t++){var e=n[t],i=o({var:e},this);null!==i&&""!==i||r.push(e)}return r},missing_some:function(r,n){var t=o({missing:n},this);return n.length-t.length>=r?[]:t},method:function(r,n,t){return r[n].apply(r,t)}};function t(r){return"object"==typeof r&&null!==r&&!Array.isArray(r)&&1===Object.keys(r).length}function e(r){return(!Array.isArray(r)||0!==r.length)&&!!r}function i(r){return Object.keys(r)[0]}function u(r){return r[i(r)]}function o(r,u){if(Array.isArray(r))return r.map((function(r){return o(r,u)}));if(!t(r))return r;u=u||{};var f,a,c,l,s,y=i(r),p=r[y];if(Array.isArray(p)||(p=[p]),"if"===y||"?:"==y){for(f=0;f<p.length-1;f+=2)if(e(o(p[f],u)))return o(p[f+1],u);return p.length===f+1?o(p[f],u):null}if("and"===y){for(f=0;f<p.length;f+=1)if(!e(a=o(p[f],u)))return a;return a}if("or"===y){for(f=0;f<p.length;f+=1)if(e(a=o(p[f],u)))return a;return a}if("filter"===y)return l=o(p[0],u),c=p[1],Array.isArray(l)?l.filter((function(r){return e(o(c,r))})):[];if("map"===y)return l=o(p[0],u),c=p[1],Array.isArray(l)?l.map((function(r){return o(c,r)})):[];if("reduce"===y)return l=o(p[0],u),c=p[1],s=void 0!==p[2]?p[2]:null,Array.isArray(l)?l.reduce((function(r,n){return o(c,{current:n,accumulator:r})}),s):s;if("all"===y){if(l=o(p[0],u),c=p[1],!l.length)return!1;for(f=0;f<l.length;f+=1)if(!e(o(c,l[f])))return!1;return!0}if("none"===y)return 0===o({filter:p},u).length;if("some"===y)return o({filter:p},u).length>0;if(p=p.map((function(r){return o(r,u)})),"function"==typeof n[y])return n[y].apply(u,p);if(y.indexOf(".")>0){var g=String(y).split("."),d=n;for(f=0;f<g.length;f++)if(void 0===(d=d[g[f]]))throw new Error("Unrecognized operation "+y+" (failed at "+g.slice(0,f+1).join(".")+")");return d.apply(u,p)}throw new Error("Unrecognized operation "+y)}r.add_operation=function(r,t){n[r]=t},r.apply=o,r.get_operator=i,r.get_values=u,r.is_logic=t,r.rm_operation=function(r){delete n[r]},r.rule_like=function r(n,e){if(e===n)return!0;if("@"===e)return!0;if("number"===e)return"number"==typeof n;if("string"===e)return"string"==typeof n;if("array"===e)return Array.isArray(n)&&!t(n);if(t(e)){if(t(n)){var o=i(e),f=i(n);if("@"===o||o===f)return r(u(n),u(e))}return!1}if(Array.isArray(e)){if(Array.isArray(n)){if(e.length!==n.length)return!1;for(var a=0;a<e.length;a+=1)if(!r(n[a],e[a]))return!1;return!0}return!1}return!1},r.truthy=e,r.uses_data=function r(n){var e=[];if(t(n)){var u=i(n),o=n[u];Array.isArray(o)||(o=[o]),"var"===u?e.push(o[0]):o.map((function(n){e.push.apply(e,r(n))}))}return function(r){for(var n=[],t=0,e=r.length;t<e;t++)-1===n.indexOf(r[t])&&n.push(r[t]);return n}(e)},Object.defineProperty(r,"__esModule",{value:!0})}));
//# sourceMappingURL=index.umd.min.js.map
